from bluekit.constants import TIMEOUT


class Exploit():
    def __init__(self, details : dict):
        self.name = details["name"]
        self.author = details["author"]
        self.type = details["type"]
        self.mass_testing = details['mass_testing']
        self.bt_version_min = details['bt_version_min']
        self.bt_version_max = details['bt_version_max']
        self.hardware = details['hardware']
        self.command = details['command']
        self.parameters = details['parameters']
        self.parameters_names = [i['name'] for i in self.parameters]
        self.log_pull = details['log_pull']
        self.directory = details['directory']

        try:
            self.max_timeout = details["max_timeout"]
        except Exception as e:
            self.max_timeout = TIMEOUT
    
    def to_json(self):
        return {
            "name": self.name,
            "author": self.author,
            "type": self.type,
            "mass_testing": self.mass_testing,
            "bt_version_min": self.bt_version_min,
            "bt_version_max": self.bt_version_max,
            "hardware": self.hardware,
            "command": self.command,
            "parameters": self.parameters,
            "log_pull": self.log_pull,
            "directory": self.directory,
            "max_timeout": self.max_timeout
        }


# done TODO add max_timeout parameter if not present set to default timeout defined in constants